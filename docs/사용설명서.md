# HWP 모의고사 자동 편집기 v2.0 — 사용 설명서

---

## 목차

1. [프로그램 소개](#1-프로그램-소개)
2. [설치 및 실행 준비](#2-설치-및-실행-준비)
3. [화면 구성](#3-화면-구성)
4. [기본 사용법 (단건 생성)](#4-기본-사용법-단건-생성)
5. [일괄 생성](#5-일괄-생성)
6. [미리보기 및 수정](#6-미리보기-및-수정)
7. [시험 유형(프리셋) 선택](#7-시험-유형프리셋-선택)
8. [설정 변경](#8-설정-변경)
9. [생성된 파일 활용법](#9-생성된-파일-활용법)
10. [자주 묻는 질문 (FAQ)](#10-자주-묻는-질문-faq)
11. [문제 해결](#11-문제-해결)
12. [원본 파일 작성 가이드](#12-원본-파일-작성-가이드)

---

## 1. 프로그램 소개

### 이 프로그램은 무엇인가요?

선생님들이 작성한 **모의고사 HWP 파일**을 학원 표준 서식에 맞게 **자동으로 변환**해주는 프로그램입니다.

### 무엇을 해주나요?

| 기능 | 설명 |
|------|------|
| 문제 자동 분리 | 원본 파일에서 문제 번호, 보기, 선지를 자동으로 인식합니다 |
| 정답/해설 분리 | 정답과 해설을 별도로 분리하여 해설지를 따로 만듭니다 |
| 서식 자동 적용 | 폰트, 글자 크기, 줄 간격, 들여쓰기 등을 일괄 적용합니다 |
| 부정문 강조 | "옳지 않은", "틀린" 등의 부정 키워드를 **굵게+밑줄** 처리합니다 |
| 2단 편집 | A4 용지에 2단 레이아웃으로 자동 배치합니다 |

### 입력과 출력

```
[입력] 선생님 원본 HWP 파일 (문제+해설 합본 또는 문제만)
                        ↓
              프로그램이 자동 변환
                        ↓
[출력] ① 문제지.hwp  — 문제, 지문, 선지만 포함
       ② 해설지.hwp  — 문제 번호, 정답, 해설만 포함 (합본인 경우)
```

### 파일 유형 자동 판별

프로그램이 원본 파일을 분석하여 자동으로 유형을 판별합니다.

- **합본 유형 (TYPE A)**: 문제 + 정답 + 해설이 모두 포함된 파일 → **문제지 + 해설지** 2개 생성
- **순수 문제지 유형 (TYPE B)**: 문제만 있는 파일 → **문제지** 1개만 생성

---

## 2. 설치 및 실행 준비

### 필수 요구 사항

| 항목 | 요구 사항 |
|------|-----------|
| 운영체제 | Windows 10 또는 Windows 11 |
| 한컴오피스 | **한글(HWP)이 반드시 설치**되어 있어야 합니다 |
| 필요 폰트 | 중고딕, 휴먼명조 (한컴오피스 설치 시 포함) |

### 실행 방법

#### 방법 1: 실행 파일(.exe)로 실행하는 경우

`dist` 또는 `build` 폴더 안의 실행 파일을 더블클릭하면 바로 실행됩니다.

#### 방법 2: Python으로 직접 실행하는 경우

1. Python 3.11 이상을 설치합니다.
2. 명령 프롬프트(CMD)를 열고 프로그램 폴더로 이동합니다.
3. 아래 명령어를 순서대로 실행합니다:

```
pip install -r requirements.txt
python main.py
```

---

## 3. 화면 구성

### 메인 화면

프로그램을 실행하면 아래와 같은 메인 화면이 나타납니다.

```
┌──────────────────────────────────────────────────┐
│  [설정]  [안내]                          (메뉴바) │
├──────────────────────────────────────────────────┤
│                                                  │
│     한국경찰학원 모의고사 편집기                  │
│     선택한 원본 파일을 동원 형식으로 자동 변환    │
│                                                  │
│  시험 유형:  [아침모의고사 ▼]                     │
│                                                  │
│  ┌──────────────────────────────────────────┐    │
│  │                                          │    │
│  │    여기에 HWP 파일을 끌어다 놓으세요     │    │
│  │       또는 클릭하여 파일 선택            │    │
│  │                                          │    │
│  └──────────────────────────────────────────┘    │
│                                                  │
│  선택한 파일 없음                                │
│  분석 결과: 대기 중                              │
│                                                  │
│  [미리보기 확인] [문제지/해설지 생성] [일괄 생성] │
│                        [결과 폴더 열기]           │
│                                                  │
│  ※ 헤더(동원명) 수정 등은 생성하지 않습니다.     │
│    1번 문제부터 편집하며 헤더는 직접 수정 필요    │
└──────────────────────────────────────────────────┘
```

### 각 영역 설명

| 영역 | 설명 |
|------|------|
| **메뉴바** | `설정` — 서식 및 환경 설정 / `안내` — 간단한 사용법 안내 |
| **시험 유형** | 아침모의고사, 정기모의고사 등 서식 프리셋 선택 |
| **파일 영역** | HWP 파일을 드래그하거나 클릭하여 선택하는 공간 |
| **분석 결과** | 파일 분석 후 문항 수, 유형, 과목 등의 정보 표시 |
| **미리보기 확인** | 분석된 문제를 하나씩 확인하고 수정할 수 있는 창 |
| **문제지/해설지 생성** | 선택한 파일로 출력 파일을 생성하는 버튼 |
| **일괄 생성** | 여러 파일을 한 번에 선택하여 일괄 변환하는 버튼 |
| **결과 폴더 열기** | 생성된 파일이 있는 폴더를 바로 여는 버튼 |

---

## 4. 기본 사용법 (단건 생성)

### 전체 흐름

```
파일 선택 → 자동 분석 → (미리보기 확인) → 생성 → 결과 확인
```

### 단계별 안내

#### STEP 1: 파일 선택

**방법 A** — 드래그 앤 드롭:
- 탐색기에서 HWP 파일을 프로그램의 파일 영역으로 끌어다 놓습니다.

**방법 B** — 클릭하여 선택:
- 파일 영역을 클릭하면 파일 선택 대화상자가 열립니다.
- 원하는 HWP 파일을 선택하고 `열기`를 누릅니다.

#### STEP 2: 자동 분석 확인

파일을 선택하면 프로그램이 자동으로 분석을 시작합니다.

분석이 완료되면 아래와 같은 정보가 표시됩니다:

```
분석 완료: 형법_모의고사.hwp | 40문항 | 유형: 문제+해설 유형 | 과목: 형법
1번 미리보기: 다음 중 형법의 기본 원칙에 대한 설명으로 가장 적절한 것은?
```

- **문항 수**: 인식된 총 문제 수
- **유형**: 합본(문제+해설) 또는 순수 문제지
- **과목**: 파일 이름에서 자동 추출

#### STEP 3: 미리보기 확인 (선택 사항)

`미리보기 확인` 버튼을 누르면 분석된 문제를 하나씩 확인할 수 있습니다.
잘못 인식된 부분이 있으면 이 단계에서 직접 수정할 수 있습니다.
(자세한 설명은 [6. 미리보기 및 수정](#6-미리보기-및-수정) 참조)

#### STEP 4: 문제지/해설지 생성

`문제지/해설지 생성` 버튼을 누르면 출력 파일 생성이 시작됩니다.

- 진행률 바가 표시되며, 현재 진행 상황을 알 수 있습니다.
- 생성이 완료되면 "생성 완료" 안내 메시지가 나타납니다.
- 생성된 파일의 경로가 메시지에 표시됩니다.

#### STEP 5: 결과 확인

`결과 폴더 열기` 버튼을 누르면 생성된 파일이 있는 폴더가 열립니다.

생성되는 파일:
- `[과목명]_문제지.hwp` — 문제, 지문, 선지만 포함
- `[과목명]_해설지.hwp` — 정답과 해설 포함 (합본 유형인 경우에만)

---

## 5. 일괄 생성

여러 과목의 파일을 한 번에 변환하고 싶을 때 사용합니다.

### 사용법

1. `일괄 생성` 버튼을 클릭합니다.
2. 파일 선택 대화상자에서 변환할 HWP 파일을 **여러 개 선택**합니다.
   - `Ctrl`+클릭으로 개별 선택, `Shift`+클릭으로 범위 선택이 가능합니다.
3. `열기`를 누르면 선택한 파일들이 순서대로 자동 변환됩니다.
4. 완료 후 결과 요약이 표시됩니다:
   - 성공한 파일 수
   - 실패한 파일 수 및 실패 원인

---

## 6. 미리보기 및 수정

### 미리보기 창 구성

```
┌──────────────────────────────────────────────────────────────┐
│  왼쪽 목록에서 문제를 선택하여 내용을 확인하고 수정할 수 있습니다  │
├────────────────────┬─────────────────────────────────────────┤
│                    │ 문제 및 지문 영역:                      │
│  ✅ 01. 다음 중... │ ┌─────────────────────────────────────┐ │
│  ✅ 02. 형법의...  │ │ 다음 중 형법의 기본원칙에 대한 설명  │ │
│  ⚠️ 03. 판례에...  │ │ 으로 가장 적절한 것은?               │ │
│  ❌ 04. (인식실패) │ │ ① 죄형법정주의란...                  │ │
│  ✅ 05. 다음 중... │ │ ② 형벌불소급의 원칙은...             │ │
│       ...          │ └─────────────────────────────────────┘ │
│                    │ 정답:                                   │
│                    │ ┌─────────────────────────────────────┐ │
│                    │ │ 정답 ③                               │ │
│                    │ └─────────────────────────────────────┘ │
│                    │ 해설 영역:                              │
│                    │ ┌─────────────────────────────────────┐ │
│                    │ │ 죄형법정주의는 법률 없이는 범죄와    │ │
│                    │ │ 형벌이 없다는 원칙으로...            │ │
│                    │ └─────────────────────────────────────┘ │
├────────────────────┴─────────────────────────────────────────┤
│              [변경사항 저장] [선택한 설정으로 변환 시작] [닫기] │
└──────────────────────────────────────────────────────────────┘
```

### 왼쪽 문제 목록의 아이콘 의미

| 아이콘 | 의미 |
|--------|------|
| ✅ | 정상적으로 인식된 문제 |
| ⚠️ | 문제는 인식되었지만 해설이 누락됨 |
| ❌ | 정답을 인식하지 못한 문제 |

### 수정 방법

1. 왼쪽 목록에서 수정할 문제를 클릭합니다.
2. 오른쪽 영역에서 **문제 본문**, **정답**, **해설**을 직접 편집합니다.
3. `변경사항 저장` 버튼을 눌러 수정 내용을 반영합니다.
4. 모든 수정이 끝나면 `선택한 설정으로 변환 시작` 또는 `닫기`를 누릅니다.

### 수정 시 주의사항

- 선지(보기)는 반드시 ①②③④⑤ 기호로 시작해야 합니다.
- 소문항(보기 내 항목)은 ㉠㉡㉢㉣ 기호로 시작해야 합니다.
- 문제 본문이 비어 있으면 저장할 수 없습니다.

---

## 7. 시험 유형(프리셋) 선택

메인 화면 상단의 **시험 유형** 드롭다운에서 원하는 서식을 선택할 수 있습니다.

### 제공되는 프리셋

| 프리셋 | 주요 설정 |
|--------|-----------|
| **아침모의고사** | 폰트: 중고딕/휴먼명조, 크기: 9.5pt, 줄 간격: 140%, 장평: 95% |
| **정기모의고사** | 폰트: 중고딕/신명조, 크기: 13.0pt/12.0pt, 줄 간격: 115%, 장평: 95% |

프리셋을 변경하면 해당 서식이 즉시 적용되어 다음 생성부터 반영됩니다.

---

## 8. 설정 변경

메뉴바의 `설정`을 클릭하면 설정 창이 열립니다.

### 일반 설정 탭

#### 출력 폴더 설정

생성된 파일이 저장될 폴더를 지정합니다.
- `변경` 버튼을 눌러 원하는 폴더를 선택합니다.
- 비어 있으면 프로그램 기본 경로(`output/`)에 저장됩니다.

#### 폰트 및 서식

| 항목 | 설명 | 기본값 |
|------|------|--------|
| 문제 폰트 | 문제 번호와 질문 텍스트에 적용되는 폰트 | 중고딕 |
| 지문 폰트 | 지문, 선지, 보기 등에 적용되는 폰트 | 휴먼명조 |
| 문제 글자 크기 | 문제 텍스트의 글자 크기 (6~20pt) | 9.5pt |
| 지문 글자 크기 | 지문 텍스트의 글자 크기 (6~20pt) | 9.5pt |
| 장평 | 글자의 가로 폭 비율 (50~200%) | 95% |
| 자간 | 글자 사이 간격 (-50~50%) | -5% |

#### 문단 설정

| 항목 | 설명 | 기본값 |
|------|------|--------|
| 줄 간격 | 줄과 줄 사이의 간격 (100~300%) | 140% |
| 내어쓰기 | 문단 첫 줄 이후의 들여쓰기 값 (0~50pt) | 13.8pt |

### HWP 스타일 설정 탭

HWP 템플릿의 스타일을 활용하여 더 정확한 서식을 적용할 수 있는 고급 설정입니다.

| 항목 | 설명 |
|------|------|
| 스타일 적용 활성화 | 체크하면 템플릿 스타일을 사용하여 서식 적용 |
| 템플릿 HWP 경로 | 스타일이 정의된 템플릿 HWP 파일 경로 |
| 스타일 이름 매핑 | 문제/지문/선지/소문항/해설에 대응하는 HWP 스타일 이름 |

> 일반적인 사용에서는 기본값으로 충분합니다. 스타일 설정은 학원 템플릿이 변경될 때만 수정하면 됩니다.

---

## 9. 생성된 파일 활용법

### 기본 활용 흐름

프로그램이 생성한 파일은 **최종 시험지가 아닙니다**.
학원의 최종 템플릿에 붙여넣기 하여 완성하는 방식으로 사용합니다.

```
프로그램으로 문제지/해설지 HWP 생성
         ↓
생성된 파일을 한글(HWP)에서 열기
         ↓
전체 선택(Ctrl+A) → 복사(Ctrl+C)
         ↓
학원 최종 템플릿 HWP에 붙여넣기(Ctrl+V)
         ↓
헤더(학원명, 날짜 등) 직접 작성
         ↓
최종 시험지 완성
```

### 프로그램이 자동 처리하는 것

- 문제 번호 인식 및 정렬
- 문제/정답/해설 분리
- 폰트, 크기, 줄 간격, 장평, 자간 등 서식 일괄 적용
- 부정 키워드("옳지 않은", "틀린" 등) **굵게+밑줄** 자동 표시
- 2단 레이아웃 배치

### 직접 처리해야 하는 것

- 헤더(학원명, 시험 날짜, 과목명 등) 작성
- 최종 페이지 레이아웃 확인 및 미세 조정
- QR코드 등 부가 요소 삽입

---

## 10. 자주 묻는 질문 (FAQ)

### Q. 한컴오피스(한글)가 꼭 설치되어 있어야 하나요?
**네.** 이 프로그램은 한컴오피스의 COM API를 사용하여 HWP 파일을 읽고 생성합니다.
한컴오피스가 설치되어 있지 않으면 파일을 분석하거나 생성할 수 없습니다.

### Q. HWP 파일 대신 HWPX 파일도 사용할 수 있나요?
현재 버전은 **.hwp 형식만** 지원합니다. HWPX 파일은 한글에서 HWP로 다시 저장한 후 사용해 주세요.

### Q. 한 번에 여러 파일을 변환할 수 있나요?
**네.** `일괄 생성` 버튼을 이용하면 여러 파일을 한 번에 선택하여 순차적으로 변환할 수 있습니다.

### Q. 생성 중에 "시간 초과" 오류가 발생합니다.
문항 수가 많거나 PC 사양이 낮은 경우 발생할 수 있습니다.
- 실행 중인 다른 한글(HWP) 창을 모두 닫은 후 다시 시도해 보세요.
- 프로그램이 자동으로 안전모드(스타일 비활성화)로 재시도합니다.

### Q. 문제 번호가 일부 인식되지 않습니다.
원본 파일의 문제 번호 형식이 프로그램이 지원하는 패턴에 맞는지 확인해 주세요.
지원하는 형식은 [12. 원본 파일 작성 가이드](#12-원본-파일-작성-가이드)를 참조하세요.

### Q. 정답이나 해설이 누락되어 나옵니다.
미리보기 창에서 ⚠️ 또는 ❌ 표시가 된 문제를 확인하고 직접 수정할 수 있습니다.
원본 파일의 정답/해설 형식이 프로그램이 인식하는 패턴과 다를 수 있습니다.

### Q. 부정 키워드가 강조 표시되지 않는 경우가 있습니다.
프로그램이 인식하는 부정 키워드 목록:
> "옳지 않은", "틀린", "적절하지 않은", "올바르지 아니한", "올바르지 않은",
> "가장 적절하지 않은", "가장 옳지 않은", "잘못된", "부적절한", "아닌 것", "않은 것"

위 목록에 없는 표현은 자동 강조되지 않습니다.

### Q. 폰트가 깨져서 나옵니다.
해당 폰트가 PC에 설치되어 있는지 확인해 주세요. 기본 폰트(중고딕, 휴먼명조)는 한컴오피스를 설치하면 함께 설치됩니다.

---

## 11. 문제 해결

| 증상 | 원인 | 해결 방법 |
|------|------|-----------|
| "한컴오피스가 설치되어 있지 않습니다" | 한글(HWP)이 미설치 | 한컴오피스를 설치하세요 |
| "문제 번호를 찾지 못했습니다" | 원본 파일의 문제 형식 불일치 | 문제 번호 형식을 확인하세요 (아래 가이드 참조) |
| 생성 중 "시간 초과" | HWP 프로세스 응답 지연 | 다른 한글 창을 닫고 재시도 |
| 폰트가 다르게 보임 | 해당 폰트 미설치 | 설정에서 PC에 있는 폰트로 변경 |
| 프로그램이 멈춤 | HWP COM 통신 오류 | 작업관리자에서 Hwp.exe 종료 후 재시도 |
| 생성은 됐지만 서식 경고 표시 | 템플릿 스타일 불일치 | 경고 내용 확인 후 설정에서 스타일 매핑 점검 |
| 일괄 생성에서 일부 실패 | 파일별 형식 차이 | 실패 목록의 오류 메시지를 확인하고 해당 파일을 개별 처리 |

### 디버그 로그 확인

문제가 반복될 경우 `output/generation_debug.log` 파일에서 상세 로그를 확인할 수 있습니다.

---

## 12. 원본 파일 작성 가이드

프로그램이 원본 파일을 정확히 인식하려면 아래 규칙을 따라 작성해 주세요.

### 문제 번호 형식 (아래 중 하나)

| 형식 | 예시 |
|------|------|
| 숫자 + 점 또는 괄호 | `1.` `02)` `3.` `40.` |
| 【 】 괄호형 | `【1】` `【02】` |
| "문" + 번호 | `문1.` `문02)` |

### 선지(보기) 형식

반드시 원문자(①②③④⑤)로 시작해야 합니다.

```
① 죄형법정주의란 법률 없이는 범죄와 형벌이 없다는 원칙이다.
② 형벌불소급의 원칙은 행위 후에 제정된 법률로 처벌할 수 없다는 것이다.
③ 유추해석의 금지는 법률이 명시하지 않은 사항을 유사한 규정으로 적용하는 것이다.
④ 명확성의 원칙은 형벌 법규가 구체적이고 명확해야 한다는 것이다.
```

### 소문항(보기 내 항목) 형식

㉠ ㉡ ㉢ ㉣ ㉤ ㉥ 기호로 시작합니다.

```
㉠ 행위 시의 법률에 의하여 범죄를 구성하지 않는 행위
㉡ 행위 시의 법률에 의하여 처벌되지 않는 행위
```

### 정답 형식 (아래 중 하나)

| 형식 | 예시 |
|------|------|
| "정답" + 원문자 | `정답 ③` `정답③` |
| "정답:" + 원문자 | `정답 : ②` `정답: ④` |
| "정답:" + 숫자 | `정답 : 3` |

### 해설 형식 (아래 중 하나)

| 형식 | 예시 |
|------|------|
| "해설" + 내용 | `해설 죄형법정주의란...` |
| "해설:" + 내용 | `해설 : 죄형법정주의란...` |
| O/X 표시 포함 | `해설 [○]` `해설 [×]` |
| 선지별 해설 | `① [○] 옳은 지문이다.` `② (×) 틀린 지문이다.` |

### 올바른 원본 파일 예시

```
1. 다음 중 형법의 기본원칙에 대한 설명으로 가장 적절한 것은?
① 죄형법정주의란 법률 없이는 범죄와 형벌이 없다는 원칙이다.
② 형벌불소급의 원칙은 행위 후에 제정된 법률로 처벌할 수 없다는 것이다.
③ 유추해석의 금지는 법률이 명시하지 않은 사항에 적용 금지이다.
④ 명확성의 원칙은 형벌 법규가 구체적이고 명확해야 한다는 것이다.

정답 ③

해설 : 유추해석 금지란 피고인에게 불리한 방향으로의 유추해석을
금지하는 원칙이다. ①은 죄형법정주의의 정의로 옳다.

2. 다음 중 형법의 적용범위에 대한 설명으로 옳지 않은 것은?
...
```

---

> **문의사항이나 오류 발생 시** `output/generation_debug.log` 파일과 함께 담당자에게 전달해 주세요.
